var bg,sDgrav,defLoc,zoneFac,gravD,hidden=!1,heightG=20,widthG=10,canHei=40*heightG/1.5,canWid=40*widthG/1.5,dGrav=.01,grav=.01,keyDown=!1,SDF=17,score=0,lock=0,lockRot=10,clearLines=0,clearLinesD=0,level=1,keyLeft=!1,keyRight=!1,das=0,dasA=10,arr=1,arrtmp=1,bag=[],bag2=[],ghostblock=[],stopped=!0,heldP=0,doHold=!0,fallingBlock=[],rainbowBlock=!1,rainbowPlace=15,zoneCharge=0,zoneTT=60,zone=!1,zoneLines=0,zoneLT=0,ghostColor=!0,boardStroke=100,backfire=!1,garboMulti=1,smooth=!1,selectKey=0,keyML=37,keyMR=39,key1R=65,keyHD=32,keySD=40,keyHL=67,keyZN=83,keyPZ=80,keyRCC=90,keyRCL=88,pushReady=!1,board=["d"],garbPushL=[],garbQ=[],Tmino=[{x:5,y:0},{x:6,y:0},{x:6,y:-1},{x:7,y:0}],Imino=[{x:4,y:0},{x:5,y:0},{x:6,y:0},{x:7,y:0}],Smino=[{x:5,y:0},{x:6,y:0},{x:6,y:-1},{x:7,y:-1}],Zmino=[{x:5,y:-1},{x:6,y:-1},{x:6,y:0},{x:7,y:0}],Lmino=[{x:4,y:0},{x:5,y:0},{x:6,y:-1},{x:6,y:0}],Jmino=[{x:4,y:0},{x:4,y:-1},{x:5,y:0},{x:6,y:0}],Omino=[{x:5,y:0},{x:5,y:-1},{x:6,y:-1},{x:6,y:0}],aTexTime=0;function jql(e){$("#console").append("<p>"+e+"</p>")}function fillBoard(){for(i=0;i<heightG*widthG;i+=1)board.push(0)}function preload(){dv=loadFont("DejaVu.ttf"),fillBoard();let e=parseInt(localStorage.getItem("boardH")),o=parseInt(localStorage.getItem("boardW"));e>=4&&null!=e&&(heightG=e),o>=4&&null!=e&&(widthG=o),canHei=40*heightG/1.5,canWid=40*widthG/1.5,zoneFac=.2/(widthG/10),bg=loadImage("assets/water.jpg")}function randNum(e,o){return Math.floor(Math.random()*(o+1-e)+e)}function findM(e){return 1==e?Tmino:2==e?Imino:3==e?Smino:4==e?Zmino:5==e?Jmino:6==e?Lmino:7==e?Omino:void 0}function colorPick(e){if(rainbowBlock){let e="rgb(";return e+=JSON.stringify(rainbowPlace),e+=",0,0)",e}return 1==e?"rgb(186, 0, 211)":2==e?"rgb(0, 229, 229)":3==e?"rgb(3, 221, 0)":4==e?"rgb(219, 0, 0)":5==e?"rgb(229, 133, 0)":6==e?"rgb(53, 0, 178)":7==e?"rgb(255, 255, 0)":8==e?"rgb(195, 138, 204)":9==e?"rgb(139, 221, 221)":10==e?"rgb(171, 226, 170)":11==e?"rgb(229, 169, 169)":12==e?"rgb(224, 192, 150)":13==e?"rgb(174, 158, 214)":14==e?"rgb(255, 255, 183)":15==e?"rgb(125,125,125)":22==e?"rgb(50,50,50)":void 0}function colorG(e){if(rainbowBlock){let e="rgb(";e+=rainbowPlace,e+=",0,0,.5)"}else{if(1==e)return"rgba(186,0,211,.5)";if(2==e)return"rgba(0,229,229,.5)";if(3==e)return"rgba(3,221,0,.5)";if(4==e)return"rgba(219,0,0,.5)";if(5==e)return"rgba(229,113,0,.5)";if(6==e)return"rgba(53,0,178,.5)";if(7==e)return"rgba(255,255,0,.5)"}}function setup(){createCanvas(canWid+20,canHei),blockReset(!0);let e=(40*widthG-400)/1.5;e+=545,defLoc=+e,$("#defaultCanvas1").css("margin-left",e+"px")}function draw(){if(textFont(dv),stopped)image(bg,-870,0,1740,1080),fill(32,32,32),textSize(50),text("Paused",canWid/2-100,canHei/2);else{if(image(bg,-870,0,1740,1080),drawBoard(),gravity(),sDgrav=dGrav*SDF,keyDown?(grav=sDgrav,score+=1):zone||(grav=sDgrav/SDF),keyLeft&&(das+=1)>dasA&&(arrtmp<arr?arrtmp+=1:(arrtmp=0,moveL())),keyRight&&(das+=1)>dasA&&(arrtmp<arr?arrtmp+=1:(arrtmp=0,moveR())),drawGhost(),drawPiece(),rainbowBlock&&(rainbowPlace<255?rainbowPlace+=1:rainbowPlace=15),zoneTT>0&&(zoneTT-=1),zone){let e=0;if(zoneCharge>=zoneFac&&0==zoneTT)zoneCharge-=zoneFac;else if(zoneCharge<zoneFac){zoneCharge=0;for(let o=0;o<heightG;o+=1){let l=!0,i=[];for(let e=1;e<widthG+1;e+=1)i.push(board[o*widthG+e]);for(let e=0;e<widthG;e+=1)i[e]<8&&(l=!1);if(l){for(let e=1;e<widthG+1;e+=1)board.splice(o*widthG+1,1);for(let e=0;e<widthG+0;e+=1)board.splice(1,0,0);e+=1}}let o=0;for(let l=0;l<e;l+=1)o+=1e3;score+=o,zone=!1,grav=gravD,zoneLines=0,zoneLT=600}}0==zoneTT&&(zoneTT=60),zoneCharge>=4&&(zoneCharge=4),clearLines>=10&&(clearLines-=10,clearLinesD+=10,level+=1,grav+=.01,dGrav+=.01),garbCheck(),drawGarbQ()}}function drawBoard(){zone&&boardStroke<150&&(boardStroke+=1),!zone&&boardStroke>100&&(boardStroke-=1),stroke(boardStroke),strokeWeight(3);let e=1;for(let o=0;o<heightG;o+=1)for(let l=0;l<widthG;l+=1){let i;noFill(),rect(l*canWid/widthG,o*canHei/heightG,canWid/widthG,canHei/heightG),board[e]>=1&&(fill(colorPick(board[e])),i=5),0==board[e]&&(fill("rgba(10, 10, 10, .7)"),i=5),rect(l*canWid/widthG,o*canHei/heightG,canWid/widthG,canHei/heightG,i,i,i,i),e+=1}}function drawPiece(){fill(colorPick(fallingBlock[5])),strokeWeight(5),stroke(100);for(let e=0;e<4;e+=1)smooth?rect((fallingBlock[e].x-1)*canWid/widthG,(fallingBlock[e].y-1)*canHei/heightG,canWid/widthG,canHei/heightG,5,5,5,5):rect((fallingBlock[e].x-1)*canWid/widthG,Math.ceil(fallingBlock[e].y-1)*canHei/heightG,canWid/widthG,canHei/heightG,5,5,5,5)}function drawGhost(){ghostblock=Array(fallingBlock.length).fill();for(let e=0;e<fallingBlock.length;e+=1)ghostblock[e]={x:fallingBlock[e].x,y:Math.floor(fallingBlock[e].y)};let e=Math.max(...ghostblock.slice(0,4).map((e=>e.y)));e:for(;e<heightG-1;){for(let e=0;e<4;e+=1)if(board[(ghostblock[e].y+1)*widthG+ghostblock[e].x]>=1)break e;for(let e=0;e<5;e+=1)ghostblock[e].y+=1;e+=1}for(ghostColor?fill(colorG(fallingBlock[5])):fill("rgba(125,125,125,.5)"),noStroke(),i=0;i<4;i+=1)rect((fallingBlock[i].x-1)*canWid/widthG,ghostblock[i].y*canHei/heightG,canWid/widthG,canHei/heightG,5,5,5,5)}function gravity(){let e=!1;for(i=0;i<5;i+=1)fallingBlock[i].y+=grav;let o=[];for(i=0;i<4;i+=1){const{x:e,y:l}=fallingBlock[i];o.push({x:e,y:l})}for(i=0;i<5;i+=1){let l=!1;(board[Math.floor(o[0].y)*widthG+o[0].x]>=1||Math.floor(o[0].y)>=heightG)&&(fallingBlock[i].y-=grav,e=!0,l=!0),(board[Math.floor(o[1].y)*widthG+o[1].x]>=1&&!l||Math.floor(o[1].y)==heightG&&!l)&&(fallingBlock[i].y-=grav,e=!0,l=!0),(board[Math.floor(o[2].y)*widthG+o[2].x]>=1&&!l||Math.floor(o[2].y)==heightG&&!l)&&(fallingBlock[i].y-=grav,e=!0,l=!0),(board[Math.floor(o[3].y)*widthG+o[3].x]>=1&&!l||Math.floor(o[3].y)==heightG&&!l)&&(fallingBlock[i].y-=grav,e=!0,l=!0)}if(e?lock+=1:(lock=0,lockRot=10),90==lock){let e=!1;(90==prevKey&&1==fallingBlock[5]||88==prevKey&&1==fallingBlock[5])&&($("#tsp").show(),aTexTime=120,e=!0,score+=200);let o=0;for(let e=0;e<4;e+=1)board[Math.floor(fallingBlock[e].y)*widthG+fallingBlock[e].x]=fallingBlock[5];blockReset(!0),lock=0,doHold=!0;let l=[],t=[];for(let e=0;e<heightG;e+=1){let i=!0,a=[];for(let o=1;o<widthG+1;o+=1)a.push(board[e*widthG+o]);for(let e=0;e<widthG;e+=1)(0==a[e]||a[e]>7&&a[e]<15)&&(i=!1);if(i){for(let o=1;o<widthG+1;o+=1)zone?t.push(e*widthG+o):board.splice(e*widthG+1,1);if(zone){let e=+a.length;for(let o=0;o<e;o+=1)l.push(+a.splice(0,1)+7);zoneLines+=1}else{for(let e=0;e<widthG+0;e+=1)board.splice(1,0,0);clearLines+=1,zoneCharge+=.125}o+=1}}for(i=t.length-1;i>=0;i-=1)board.splice(t[i],1);let a=l.length;for(i=0;i<a;i+=1)board.push(+l.splice(0,1));1==o&&(score+=200,$("#sig").show(),aTexTime=120,e&&(score+=400,el_Garbagio(2,randNum(0,widthG-1)))),2==o&&(score+=300,$("#dob").show(),aTexTime=120,e?(score+=800,el_Garbagio(4,randNum(0,widthG-1))):el_Garbagio(1,randNum(0,widthG-1))),3==o&&(score+=500,$("#trp").show(),aTexTime=120,e?(score+=1600,el_Garbagio(6,randNum(0,widthG-1))):el_Garbagio(2,randNum(0,widthG-1))),4==o&&(score+=1e3,$("#qwd").show(),aTexTime=120,el_Garbagio(4,randNum(0,widthG-1))),garbPush()}}function hardDrop(){let e=0;for(i=0;i<4;i+=1)board[Math.floor(ghostblock[i].y)*widthG+fallingBlock[i].x]=fallingBlock[5];let o=Math.max(...ghostblock.slice(0,4).map((e=>e.y)));score+=100/o,blockReset(!0),lock=0,doHold=!0;let l=[],t=[];for(let o=0;o<heightG;o+=1){let i=!0,a=[];for(let e=1;e<=widthG;e+=1)a.push(board[o*widthG+e]);for(let e=0;e<widthG;e+=1)(0==a[e]||a[e]>7&&a[e]<15)&&(i=!1);if(i){for(let e=1;e<=widthG;e+=1)zone?t.push(o*widthG+e):board.splice(o*widthG+1,1);if(zone){let e=+a.length;for(let o=0;o<e;o+=1)l.push(+a.splice(0,1)+7);zoneLines+=1}else{for(let e=0;e<widthG+0;e+=1)board.splice(1,0,0);clearLines+=1,zoneCharge+=.125}e+=1}}for(i=t.length-1;i>=0;i-=1)board.splice(t[i],1);let a=l.length;for(i=0;i<a;i+=1)board.push(+l.splice(0,1));1==e&&(score+=200,$("#sig").show(),aTexTime=120),2==e&&(score+=300,$("#dob").show(),aTexTime=120,el_Garbagio(1,randNum(0,widthG-1))),3==e&&(score+=500,$("#trp").show(),aTexTime=120,el_Garbagio(2,randNum(0,widthG-1))),4==e&&(score+=1e3,$("#qwd").show(),aTexTime=120,el_Garbagio(4,randNum(0,widthG-1))),garbPush()}function blockReset(e){if(fallingBlock.splice(0,fallingBlock.length),bag.length>0){switch(+bag.splice(0,1)){case 1:for(i=0;i<4;i+=1){const{x:e,y:o}=Tmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:6,y:0},1,0);break;case 2:for(i=0;i<4;i+=1){const{x:e,y:o}=Imino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:-1},2,0);break;case 3:for(i=0;i<4;i+=1){const{x:e,y:o}=Smino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},3,0);break;case 4:for(i=0;i<4;i+=1){const{x:e,y:o}=Zmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},4,0);break;case 5:for(i=0;i<4;i+=1){const{x:e,y:o}=Jmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},5,0);break;case 6:for(i=0;i<4;i+=1){const{x:e,y:o}=Lmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},6,0);break;case 7:for(i=0;i<4;i+=1){const{x:e,y:o}=Omino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5.5,y:-.5},7,0)}}else 0==bag2.length?(uniListGen(bag,7,1,7),uniListGen(bag2,7,1,7)):(bag=bag2.splice(0,bag2.length),uniListGen(bag2,7,1,7)),blockReset(e);let o=0;e:for(i=0;i<4;i+=1)if(1==board[10*Math.floor(fallingBlock[i].y+1)+fallingBlock[i].x]){if(zone){zoneCharge=0,zone=!1,zoneTT=60;for(let e=0;e<heightG;e+=1){let l=!0,i=[];for(let o=1;o<widthG+1;o+=1)i.push(board[e*widthG+o]);for(let e=0;e<widthG;e+=1)i[e]<8&&(l=!1);if(l){for(let o=1;o<widthG+1;o+=1)board.splice(e*widthG+1,1);for(let e=0;e<widthG+0;e+=1)board.splice(1,0,0);o+=1}}grav=+gravD,zoneLT=600;let e=0;for(let l=0;l<o;l+=1)e+=2e3;score+=e;break e}reset()}}function uniListGen(e,o,l,i){let t=!1;if(i+1-l<o?console.log("too small you pleb"):t=!0,t){let t=[];for(let e=l;e<i+1;e+=1)t.push(e);for(let l=0;l<o;l+=1){let o=randNum(0,t.length-1);e.push(t[o]),t.splice(o,1)}}return e}function reset(){bag=[],bag2=[],board=["d"],blockReset(!0),fillBoard(),drawBoard(),score=0,heldP=0,stopped=!0,zoneCharge=0,zone=!1,zoneTT=60,clearLines=0,clearLinesD=0,lines=0,level=1,gravD=.01,dGrav=grav=.01,alert("Game Over :(")}function moveL(){for(let e=0;e<5;e+=1)fallingBlock[e].x-=1;for(let e=0;e<4;e+=1)if(board[Math.floor(fallingBlock[e].y)*widthG+fallingBlock[e].x]>=1||fallingBlock[e].x<=0)for(let e=0;e<5;e+=1)fallingBlock[e].x+=1;pieceCheck()}function moveR(){for(let e=0;e<5;e+=1)fallingBlock[e].x+=1;for(let e=0;e<4;e+=1)if(board[Math.floor(fallingBlock[e].y)*widthG+fallingBlock[e].x]>=1||fallingBlock[e].x>=widthG+1)for(let e=0;e<5;e+=1)fallingBlock[e].x-=1;pieceCheck()}function rotClock(){lockRot>0&&(lock=0,lockRot-=1);const{x:e,y:o}=fallingBlock[4];for(let l=0;l<4;l+=1){const{x:i,y:t}=fallingBlock[l];fallingBlock[l].x=-(t-o)+e,fallingBlock[l].y=i-e+o}for(let e=0;e<4;e+=1)if(fallingBlock[e].x>=widthG+1)for(let e=0;e<4;e+=1)fallingBlock[e].x-=1;else if(fallingBlock[e].x<=0)for(let e=0;e<4;e+=1)fallingBlock[e].x+=1}function rotCount(){lockRot>0&&(lock=0,lockRot-=1);const{x:e,y:o}=fallingBlock[4];for(let l=0;l<4;l+=1){const{x:i,y:t}=fallingBlock[l];fallingBlock[l].x=t-o+e,fallingBlock[l].y=-(i-e)+o}for(let e=0;e<4;e+=1)if(fallingBlock[e].x>=widthG+1)for(let e=0;e<4;e+=1)fallingBlock[e].x-=1;else if(fallingBlock[e].x<=0)for(let e=0;e<4;e+=1)fallingBlock[e].x+=1}function rot180(){lockRot>0&&(lock=0,lockRot-=1);const{x:e,y:o}=fallingBlock[4];for(let l=0;l<4;l+=1){const{x:i,y:t}=fallingBlock[l];fallingBlock[l].x=t-o+e,fallingBlock[l].y=-(i-e)+o}for(let l=0;l<4;l+=1){const{x:i,y:t}=fallingBlock[l];fallingBlock[l].x=t-o+e,fallingBlock[l].y=-(i-e)+o}for(let e=0;e<4;e+=1)if(fallingBlock[e].x>=widthG+1)for(let e=0;e<4;e+=1)fallingBlock[e].x-=1;else if(fallingBlock[e].x<=0)for(let e=0;e<4;e+=1)fallingBlock[e].x+=1}function keyCheck(e,o,l,i){let t=!0,a=!1;null!=i&&(t=!i),(t||prevKey!=e)&&(l!=e||stopped||(o(),a=!0),!a&&80==e&&stopped&&o())}function pieceCheck(){e:for(let e=0;e<4;e+=1){if(board[10*Math.floor(fallingBlock[e].y)+fallingBlock[e].x]>=1||fallingBlock[e].x>=11){for(let e=0;e<4;e+=1)fallingBlock[e].x-=1;if(!board[10*Math.floor(fallingBlock[e].y)+fallingBlock[e].x]>=1&&!fallingBlock[e].x>=11)break e;for(let e=0;e<4;e+=1)fallingBlock[e].x+=1}if(board[10*Math.floor(fallingBlock[e].y)+fallingBlock[e].x]>=1||fallingBlock[e].x<=0){for(let e=0;e<4;e+=1)fallingBlock[e].x+=1;if(!board[10*Math.floor(fallingBlock[e].y)+fallingBlock[e].x]>=1&&!fallingBlock[e].x<=0)break e;for(let e=0;e<4;e+=1)fallingBlock[e].x-=1}}}function hold(){if(doHold)if(0==heldP)heldP=+fallingBlock[5],blockReset(!0),doHold=!1;else{let e=heldP.valueOf();switch(heldP=fallingBlock[5].valueOf(),fallingBlock.splice(0,fallingBlock.length),e){case 1:for(i=0;i<4;i+=1){const{x:e,y:o}=Tmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:6,y:0},1,0);break;case 2:for(i=0;i<4;i+=1){const{x:e,y:o}=Imino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:-1},2,0);break;case 3:for(i=0;i<4;i+=1){const{x:e,y:o}=Smino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},3,0);break;case 4:for(i=0;i<4;i+=1){const{x:e,y:o}=Zmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},4,0);break;case 5:for(i=0;i<4;i+=1){const{x:e,y:o}=Jmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},5,0);break;case 6:for(i=0;i<4;i+=1){const{x:e,y:o}=Lmino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5,y:0},6,0);break;case 7:for(i=0;i<4;i+=1){const{x:e,y:o}=Omino[i];fallingBlock.push({x:e,y:o})}fallingBlock.push({x:5.5,y:-.5},7,0)}doHold=!1}}function pD(e,o,l,i){if(0!=l){let t=20,a=findM(l);for(let r=0;r<4;r+=1)e.fill(colorPick(+l)),!doHold&&i&&e.fill(30,30,30),e.rect((a[r].x-1.5)*t,(a[r].y+1+o)*t,t,t,5,5,5,5)}}function drawNextQ(e){let o=[],l=1.5;for(let e=0;e<bag.length;e+=1)o.push(bag[e]);for(let e=0;e<bag2.length;e+=1)o.push(bag2[e]);for(let i=0;i<6;i+=1)pD(e,l,o[i],!1),l+=2.5}var prevKey=null;function el_Garbagio(e,o){let l=Math.floor(e*garboMulti);if(garbQ.length>0&&!zone)if(garbQ.length>=l){for(i=0;i<l;i+=1)garbQ.splice(0,1);l=0}else for(i=0;i<garbQ.length;i+=1)garbQ.splice(0,1),l-=1;if(backfire&&!zone)for(i=0;i<l;i+=1)garbQ.push({os:o,t:120})}function drawGarbQ(){noStroke(),fill("rgba(10, 10, 10, .7)"),rect(canWid,0,20,canHei),fill(200,0,0),garbQ.length>0&&rect(canWid,canHei-garbQ.length*canHei/heightG,20,garbQ.length*canHei/heightG,5,5,5,5),noFill(),stroke(boardStroke),strokeWeight(3),rect(canWid,0,20,canHei),rect(canWid,0,20,canHei,5,5,5,5)}function garbCheck(){for(i=0;i<garbQ.length;i+=1)garbQ[i].t>0?garbQ[i].t-=1:(pushReady=!0,garbPushL.push(i))}function garbPush(){if(pushReady)for(i=0;i<garbPushL.length;i+=1){let e=garbQ[0].os;for(j=0;j<widthG;j+=1)board.splice(1,1),j!=e?board.push(15):board.push(0);garbQ.splice(0,1),garbPushL.splice(0,1),pushReady=!1}}function keySetStart(e){selectKey=e,$("#KL"+e).html("Setting...")}function keySBR(){$(".setKY").html("Set New")}function setKeyDisp(){37!=keyML?$("#KD1").html("Left: "+keyML):$("#KD1").html("Left: Left Arrow"),39!=keyMR?$("#KD2").html("Right: "+keyMR):$("#KD2").html("Right: Right Arrow"),65!=key1R?$("#KD7").html("Rotate 180: "+key1R):$("#KD7").html("Rotate 180: A"),32!=keyHD?$("#KD4").html("Hard Drop: "+keyHD):$("#KD4").html("Hard Drop: Space"),40!=keySD?$("#KD3").html("Soft Drop: "+keySD):$("#KD3").html("Soft Drop: Down Arrow"),67!=keyHL?$("#KD9").html("Hold: "+keyHD):$("#KD9").html("Hold: C"),83!=keyZN?$("#KD8").html("Enter Zone Mode: "+keyZL):$("#KD8").html("Enter Zone Mode: S"),80!=keyPZ?$("#KD10").html("Pause: "+keyPZ):$("#KD10").html("Pause: P"),90!=keyRCC?$("#KD5").html("Rotate Counter-Clockwise: "+keyRCC):$("#KD5").html("Rotate Counter-Clockwise: Z"),88!=keyRCL?$("#KD6").html("Rotate Clockwise: "+keyRCL):$("#KD6").html("Rotate Clockwise: X")}$(document).ready((function(){$("#setHeight").click((function(){localStorage.setItem("boardH",$("#bHi").val()),alert("board height set!")})),$("#setWidth").click((function(){localStorage.setItem("boardW",$("#bWi").val()),alert("board width set!")})),$("#garbBack").on("input",(function(){garboMulti=+$("#garbBack").val()})),$("#das").on("input",(function(){dasA=$("#das").val()})),$("#arr").on("input",(function(){arr=$("#arr").val(),arrtemp=$("#arr").val()})),$("#sdf").on("input",(function(){SDF=$("#sdf").val()})),window.onkeydown=function(e){if(0==selectKey)e.keyCode==keySD&&(keyDown=!0),keyCheck(key1R,(function(){rot180()}),e.keyCode,e.repeat),keyCheck(keyML,(function(){keyLeft=!0,moveL()}),e.keyCode,e.repeat),keyCheck(keyMR,(function(){keyRight=!0,moveR()}),e.keyCode,e.repeat),keyCheck(keyHD,(function(){hardDrop()}),e.keyCode,e.repeat),keyCheck(keyRCL,(function(){rotClock()}),e.keyCode,e.repeat),keyCheck(keyRCC,(function(){rotCount()}),e.keyCode,e.repeat),keyCheck(keyHL,(function(){hold()}),e.keyCode,e.repeat),keyCheck(keyZN,(function(){!zone&&zoneCharge>0&&(zone=!0,gravD=+grav,grav=0,zoneLines=0)}),e.keyCode,e.repeat),keyCheck(keyPZ,(function(){stopped=!stopped}),e.keyCode,e.repeat);else{switch(selectKey){case 1:keyML=e.keyCode,selectKey=0,keySBR();break;case 2:keyMR=e.keyCode,selectKey=0,keySBR();break;case 3:keySD=e.keyCode,selectKey=0,keySBR();break;case 4:keyHD=e.keyCode,selectKey=0,keySBR();break;case 5:keyRCC=e.keyCode,selectKey=0,keySBR();break;case 6:keyRCL=e.keyCode,selectKey=0,keySBR();break;case 7:key1R=e.keyCode,selectKey=0,keySBR();break;case 8:keyZN=e.keyCode,selectKey=0,keySBR();break;case 9:keyHL=e.keyCode,selectKey=0,keySBR();break;case 10:keyPZ=e.keyCode,selectKey=0,keySBR()}setKeyDisp()}prevKey=e.keyCode},window.onkeyup=function(e){e.keyCode==keySD&&(keyDown=!1),e.keyCode==keyML&&(keyLeft=!1,das=0,arrtmp=arr),e.keyCode==keyMR&&(keyRight=!1,das=0,arrtmp=arr)},setInterval((function(){$("#score").html("Score: "+Math.floor(score).toLocaleString("de")),$("#zoneChargeMet").attr("value",zoneCharge),$("#level").html("Level: "+level.toLocaleString("de")),$("#lines").html("Lines: "+(clearLinesD+clearLines).toLocaleString("de")),ghostColor?$("#colorBut").html("Disable"):$("#colorBut").html("Enable"),backfire?$("#backBut").html("Disable"):$("#backBut").html("Enable"),smooth?$("#smoothBut").html("Disable"):$("#smoothBut").html("Enable"),aTexTime>0?aTexTime-=1:($("#tsp").hide(),$("#sig").hide(),$("#dob").hide(),$("#trp").hide(),$("#qwd").hide()),zone?($("#zoneL").show(),$("#zoneL").html("Zone Lines: "+zoneLines)):zoneLT<1?$("#zoneL").hide():zoneLT-=1}),1e3/60);new p5((e=>{e.setup=()=>{e.createCanvas(200,100)},e.draw=()=>{e.image(bg,0,-900,1740,1080),stopped||(e.fill("rgba(10,10,10,.7)"),e.rect(0,0,300,550),e.fill(200),e.textFont(dv),e.textSize(20),e.noStroke(),e.text("Hold",10,20),e.stroke(100),e.strokeWeight(3),pD(e,1.5,heldP,!0))}}),"holdQ");new p5((e=>{e.setup=()=>{e.createCanvas(200,450)},e.draw=()=>{e.image(bg,0,0,1740,1080),stopped||(e.fill("rgba(10,10,10,.7)"),e.rect(0,0,300,550),e.fill(200),e.textFont(dv),e.textSize(20),e.noStroke(),e.text("Next",10,20),e.stroke(100),e.strokeWeight(3),drawNextQ(e))}}),"nextQ")}));
